<!doctype html>
<html lang="zh-Hant">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>å¤šèªæ‰‹å¯«æœ—è®€å·¥å…·</title>
    <meta name="theme-color" content="#0ea5e9" />
    <style>
        :root {
            --bg: #0b1220;
            --card: #111827;
            --muted: #6b7280;
            --text: #e5e7eb;
            --accent: #22d3ee;
            --btn: #0ea5e9;
            --danger: #ef4444;
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            background: linear-gradient(180deg, #0b1220, #0f172a);
            color: var(--text);
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
        }

        .wrap {
            max-width: 680px;
            margin: 0 auto;
            padding: clamp(16px, 5vw, 28px);
        }

        .app {
            background: linear-gradient(180deg, #0c1222, #0c1827);
            border: 1px solid #1f2937;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, .35);
        }

        header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-bottom: 1px solid #1f2937;
            background: #0b1220;
            position: sticky;
            top: 0;
        }

        header .logo {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: radial-gradient(circle at 30% 30%, #22d3ee, #0ea5e9 60%, #0369a1);
        }

        .section {
            padding: 16px
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 14px
        }

        .label {
            font-size: 13px;
            color: #cbd5e1
        }

        textarea,
        select,
        input[type=range] {
            width: 100%;
            border-radius: 14px;
            border: 1px solid #1f2937;
            background: #0b1220;
            color: var(--text);
            padding: 14px;
            font-size: 16px;
            resize: vertical;
        }

        canvas {
            width: 100%;
            height: 50vh;
            background: #111827;
            border-radius: 16px;
            touch-action: none;
        }

        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 8px 0
        }

        .chip {
            padding: 8px 12px;
            border-radius: 999px;
            border: 1px solid #1f2937;
            background: #0b1220;
            color: #cbd5e1;
            font-size: 13px;
            cursor: pointer;
        }

        button {
            flex: 1;
            border: none;
            border-radius: 14px;
            padding: 14px 16px;
            font-weight: 600;
            font-size: 16px;
        }

        .primary {
            background: var(--btn);
            color: #00111a
        }

        .danger {
            background: var(--danger);
            color: #fff
        }

        #ipa {
            color: #22d3ee;
            text-align: center;
            padding: 8px 0;
            white-space: pre-wrap
        }

        /* ---- ä¸¦æ’ row ---- */
        .row-fields {
            display: flex;
            flex-direction: row;
            gap: 16px;
            margin-bottom: 14px;
            flex-wrap: nowrap;
        }

        .row-fields .sub-field {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        .pad-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="app">
            <header>
                <div class="logo" aria-hidden="true"></div>
                <div>
                    <h1 style="margin:0;font-size:18px;">å¤šèªæ‰‹å¯«èªéŸ³å·¥å…·</h1>
                    <p style="margin:0;font-size:12px;color:#6b7280">æ”¯æ´æ‰‹å¯« + èªéŸ³ + IPA Â· Mobile-first</p>
                </div>
            </header>

            <div class="section">

                <!-- èªè¨€ / èªéŸ³ -->
                <div class="row-fields">
                    <div class="sub-field">
                        <label class="label" for="lang">é¸æ“‡èªè¨€</label>
                        <select id="lang">
                            <option value="en-US">English ğŸ‡ºğŸ‡¸</option>
                            <option value="it-IT">Italiano ğŸ‡®ğŸ‡¹</option>
                            <option value="zh-TW">ä¸­æ–‡ (ç¹é«”) ğŸ‡¹ğŸ‡¼</option>
                            <option value="ja-JP">æ—¥æœ¬èª ğŸ‡¯ğŸ‡µ</option>
                            <option value="fr-FR">FranÃ§ais ğŸ‡«ğŸ‡·</option>
                            <option value="de-DE">Deutsch ğŸ‡©ğŸ‡ª</option>
                            <option value="es-ES">EspaÃ±ol ğŸ‡ªğŸ‡¸</option>
                            <option value="pt-PT">PortuguÃªs ğŸ‡µğŸ‡¹</option>
                            <option value="ru-RU">Ğ ÑƒÑÑĞºĞ¸Ğ¹ ğŸ‡·ğŸ‡º</option>
                            <option value="hi-IN">à¤¹à¤¿à¤¨à¥à¤¦à¥€ / Ø§ÙØ±Ø¯ÙÙˆ (å°åœ°-çƒçˆ¾éƒ½èª) ğŸ‡®ğŸ‡³</option>
                            <option value="bn-BD">à¦¬à¦¾à¦‚à¦²à¦¾ (å­ŸåŠ æ‹‰èª) ğŸ‡§ğŸ‡©</option>
                            <option value="fa-IR">ÙØ§Ø±Ø³ÛŒ (æ³¢æ–¯èª) ğŸ‡®ğŸ‡·</option>
                            <option value="ta-IN">à®¤à®®à®¿à®´à¯ (å¦ç±³çˆ¾èª) ğŸ‡®ğŸ‡³</option>
                            <option value="ar-SA">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (é˜¿æ‹‰ä¼¯èª) ğŸ‡¸ğŸ‡¦</option>
                            <option value="tr-TR">TÃ¼rkÃ§e (åœŸè€³å…¶èª) ğŸ‡¹ğŸ‡·</option>
                            <option value="ko-KR">í•œêµ­ì–´ ğŸ‡°ğŸ‡·</option>
                            <option value="vi-VN">Tiáº¿ng Viá»‡t ğŸ‡»ğŸ‡³</option>
                            <option value="id-ID">Bahasa Indonesia / Melayu ğŸ‡®ğŸ‡©</option>
                            <option value="th-TH">à¹„à¸—à¸¢ ğŸ‡¹ğŸ‡­</option>
                            <option value="sw-KE">Kiswahili (æ–¯ç“¦å¸Œé‡Œèª) ğŸ‡°ğŸ‡ª</option>
                        </select>
                    </div>
                    <div class="sub-field">
                        <label class="label" for="voice">èªéŸ³é¸æ“‡</label>
                        <select id="voice"></select>
                    </div>
                </div>


                <!-- è¼¸å…¥æ–‡å­— -->
                <div class="field">
                    <label class="label">è¼¸å…¥è¦æœ—è®€çš„æ–‡å­—ï¼ˆä¹Ÿæœƒé¡¯ç¤ºåœ¨æ‰‹å¯«å€èƒŒæ™¯ï¼‰</label>
                    <textarea id="text" placeholder="ä¾‹å¦‚ï¼šCiao! Come stai?"></textarea>
                    <div class="chips" id="samples"></div>
                </div>

                <!-- èªé€Ÿ / éŸ³é«˜ -->
                <div class="row-fields">
                    <div class="sub-field">
                        <label class="label">èªé€Ÿ <span id="rateVal">1.0</span></label>
                        <input type="range" id="rate" min="0.6" max="1.6" step="0.1" value="1.0">
                    </div>
                    <div class="sub-field">
                        <label class="label">éŸ³é«˜ <span id="pitchVal">1.0</span></label>
                        <input type="range" id="pitch" min="0.6" max="1.4" step="0.1" value="1.0">
                    </div>
                </div>

                <!-- å­—é«”å¤§å° -->
                <div class="field">
                    <label class="label">å­—é«”å¤§å° <span id="fontSizeVal">72</span> px</label>
                    <input type="range" id="fontSize" min="16" max="240" step="1" value="32">
                </div>

                <div id="ipa" style="display:none"></div>

                <!-- æ‰‹å¯«å€ -->
                <div class="field">
                    <label class="label">æ‰‹å¯«ç·´ç¿’å€</label>
                    <canvas id="pad"></canvas>
                    <div class="pad-actions">
                        <button class="danger" id="clearBtn">ğŸ§¹ æ¸…é™¤ç•«å¸ƒ</button>
                        <button class="primary" id="speakBtn">â–¶ é–‹å§‹æœ—è®€</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        const langEl = document.getElementById('lang');
        const voiceEl = document.getElementById('voice');
        const textEl = document.getElementById('text');
        const rateEl = document.getElementById('rate');
        const pitchEl = document.getElementById('pitch');
        const rateVal = document.getElementById('rateVal');
        const pitchVal = document.getElementById('pitchVal');
        const fontSizeEl = document.getElementById('fontSize');
        const fontSizeVal = document.getElementById('fontSizeVal');
        const ipaEl = document.getElementById('ipa');
        const canvas = document.getElementById('pad');
        const ctx = canvas.getContext('2d');
        const samplesEl = document.getElementById('samples');
        const DPR = window.devicePixelRatio || 1;
        let strokes = []; let isDrawing = false; let currentStroke = null;
        let customFontSize = 72; // ç”±æ»‘æ¡¿æ§åˆ¶

        const SAMPLE_TEXTS = {
            "en-US": ["Hello", "Hi", "Good morning", "Good evening"],
            "it-IT": ["Ciao", "Salve", "Buongiorno", "Buonasera"],
            "zh-TW": ["ä½ å¥½", "å—¨", "æ—©å®‰", "æ™šå®‰"],
            "ja-JP": ["ã“ã‚“ã«ã¡ã¯", "ã‚„ã‚", "ãŠã¯ã‚ˆã†", "ã“ã‚“ã°ã‚“ã¯"],
            "fr-FR": ["Bonjour", "Salut", "Bonsoir", "Coucou"],
            "de-DE": ["Hallo", "Guten Tag", "Guten Morgen", "Guten Abend"],
            "es-ES": ["Hola", "Buenos dÃ­as", "Buenas tardes", "Buenas noches"],
            "pt-PT": ["OlÃ¡", "Oi", "Bom dia", "Boa noite"],
            "ru-RU": ["ĞŸÑ€Ğ¸Ğ²ĞµÑ‚", "Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ", "Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğµ ÑƒÑ‚Ñ€Ğ¾", "Ğ”Ğ¾Ğ±Ñ€Ñ‹Ğ¹ Ğ²ĞµÑ‡ĞµÑ€"],
            "hi-IN": ["à¤¨à¤®à¤¸à¥à¤¤à¥‡", "à¤¹à¥ˆà¤²à¥‹", "à¤¸à¥à¤ªà¥à¤°à¤­à¤¾à¤¤", "à¤¶à¥à¤­ à¤¸à¤‚à¤§à¥à¤¯à¤¾"],
            "bn-BD": ["à¦¹à§à¦¯à¦¾à¦²à§‹", "à¦¨à¦®à¦¸à§à¦•à¦¾à¦°", "à¦¶à§à¦­ à¦¸à¦•à¦¾à¦²", "à¦¶à§à¦­ à¦¸à¦¨à§à¦§à§à¦¯à¦¾"],
            "fa-IR": ["Ø³Ù„Ø§Ù…", "Ø¯Ø±ÙˆØ¯", "ØµØ¨Ø­ Ø¨Ø®ÛŒØ±", "Ø¹ØµØ± Ø¨Ø®ÛŒØ±"],
            "ta-IN": ["à®µà®£à®•à¯à®•à®®à¯", "à®¹à®²à¯‹", "à®•à®¾à®²à¯ˆ à®µà®£à®•à¯à®•à®®à¯", "à®®à®¾à®²à¯ˆ à®µà®£à®•à¯à®•à®®à¯"],
            "ar-SA": ["Ù…Ø±Ø­Ø¨Ø§", "Ø£Ù‡Ù„Ø§", "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±", "Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±"],
            "tr-TR": ["Merhaba", "Selam", "GÃ¼naydÄ±n", "Ä°yi akÅŸamlar"],
            "ko-KR": ["ì•ˆë…•í•˜ì„¸ìš”", "ì•ˆë…•", "ì¢‹ì€ ì•„ì¹¨", "ì•ˆë…•íˆ ì£¼ë¬´ì„¸ìš”"],
            "vi-VN": ["Xin chÃ o", "ChÃ o báº¡n", "ChÃ o buá»•i sÃ¡ng", "ChÃ o buá»•i tá»‘i"],
            "id-ID": ["Halo", "Hai", "Selamat pagi", "Selamat malam"],
            "th-TH": ["à¸ªà¸§à¸±à¸ªà¸”à¸µ", "à¸«à¸§à¸±à¸”à¸”à¸µ", "à¸­à¸£à¸¸à¸“à¸ªà¸§à¸±à¸ªà¸”à¸´à¹Œ", "à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸¢à¹‡à¸™"],
            "sw-KE": ["Hujambo", "Habari", "Asubuhi njema", "Usiku mwema"]
        };


        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * DPR; canvas.height = rect.height * DPR;
            ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
            ctx.lineWidth = 2; ctx.lineJoin = 'round'; ctx.lineCap = 'round'; ctx.strokeStyle = '#22d3ee';
            redraw();
        }
        window.addEventListener('resize', resizeCanvas);

        function wrapTextSmart(text, maxW, fontSize) {
            ctx.font = `${fontSize}px sans-serif`;
            const useWords = /\s/.test(text);
            const units = useWords ? text.split(/\s+/) : [...text];
            const lines = []; let line = '';
            for (const u of units) {
                const test = line ? (useWords ? line + ' ' + u : line + u) : u;
                if (ctx.measureText(test).width > maxW * 0.92 && line) { lines.push(line); line = u; }
                else line = test;
            }
            if (line) lines.push(line);
            return lines.slice(0, 6);
        }
        function drawBackgroundText() {
            const text = textEl.value.trim();
            ctx.save(); ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillStyle = 'rgba(200,200,200,0.25)';
            const maxW = canvas.width / DPR, maxH = canvas.height / DPR;
            if (text) {
                const fs = customFontSize;
                const lines = wrapTextSmart(text, maxW, fs);
                ctx.font = `${fs}px sans-serif`; const lh = fs * 1.2;
                const startY = (maxH / 2) - ((lines.length - 1) * lh / 2);
                lines.forEach((line, i) => ctx.fillText(line, maxW / 2, startY + i * lh));
            } else { ctx.font = '20px sans-serif'; ctx.fillText('åœ¨æ­¤æ‰‹å¯«â€¦', maxW / 2, maxH / 2); }
            ctx.restore();
        }
        function drawStrokes() {
            ctx.save(); ctx.strokeStyle = '#22d3ee'; ctx.lineWidth = 4; ctx.lineJoin = 'round'; ctx.lineCap = 'round';
            const draw = s => {
                if (!s || s.length < 2) return; ctx.beginPath(); ctx.moveTo(s[0].x, s[0].y);
                for (let i = 1; i < s.length; i++)ctx.lineTo(s[i].x, s[i].y); ctx.stroke();
            };
            strokes.forEach(draw); if (currentStroke) draw(currentStroke); ctx.restore();
        }
        function redraw() { ctx.clearRect(0, 0, canvas.width, canvas.height); drawBackgroundText(); drawStrokes(); }

        function posFromEvent(e) { const r = canvas.getBoundingClientRect(); return { x: e.clientX - r.left, y: e.clientY - r.top }; }
        canvas.addEventListener('pointerdown', e => { canvas.setPointerCapture(e.pointerId); isDrawing = true; currentStroke = [posFromEvent(e)]; redraw(); });
        canvas.addEventListener('pointermove', e => { if (!isDrawing) return; currentStroke.push(posFromEvent(e)); redraw(); });
        function endStroke() { if (isDrawing && currentStroke?.length) { strokes.push(currentStroke); currentStroke = null; redraw(); } isDrawing = false; }
        canvas.addEventListener('pointerup', endStroke);
        canvas.addEventListener('pointercancel', endStroke);
        canvas.addEventListener('pointerleave', endStroke);
        document.getElementById('clearBtn').addEventListener('click', () => { strokes = []; redraw(); });

        function loadVoices() {
            const voices = speechSynthesis.getVoices(); const lang = langEl.value;
            voiceEl.innerHTML = ''; const list = voices.filter(v => v.lang === lang);
            (list.length ? list : voices).forEach(v => {
                const opt = document.createElement('option'); opt.value = v.name; opt.textContent = `${v.name} (${v.lang})`;
                voiceEl.appendChild(opt);
            });
        }
        speechSynthesis.onvoiceschanged = loadVoices;

        function speakNow() {
            const text = textEl.value.trim(); if (!text) return;
            const u = new SpeechSynthesisUtterance(text);
            const voices = speechSynthesis.getVoices(); const sel = voices.find(v => v.name === voiceEl.value);
            if (sel) u.voice = sel; u.lang = langEl.value; u.rate = parseFloat(rateEl.value); u.pitch = parseFloat(pitchEl.value);
            speechSynthesis.cancel(); speechSynthesis.speak(u);
            if (langEl.value === 'en-US') fetchIPA(text);
        }
        function fetchIPA(text) {
            ipaEl.style.display = 'block'; ipaEl.textContent = 'ğŸ”„ æŸ¥è©¢ IPA ä¸­...';
            const word = text.split(/\s+/)[0] || '';
            fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`)
                .then(res => res.json())
                .then(data => {
                    const phon = data?.[0]?.phonetics?.find(p => p.text)?.text;
                    const meanings = data?.[0]?.meanings?.[0]?.definitions?.[0]?.definition;
                    ipaEl.textContent = phon ? `ğŸ“˜ IPA: ${phon}${meanings ? '\n' + meanings : ''}` : 'æ‰¾ä¸åˆ° IPA è³‡è¨Š';
                })
                .catch(() => ipaEl.textContent = 'âŒ æŸ¥è©¢å¤±æ•—');
        }

        langEl.addEventListener('change', () => {
            loadVoices(); textEl.placeholder = SAMPLE_TEXTS[langEl.value]?.[0] || ''; renderChips();
            if (langEl.value !== 'en-US') { ipaEl.style.display = 'none'; ipaEl.textContent = ''; }
        });
        rateEl.addEventListener('input', () => { rateVal.textContent = rateEl.value; });
        pitchEl.addEventListener('input', () => { pitchVal.textContent = pitchEl.value; });
        fontSizeEl.addEventListener('input', () => {
            customFontSize = parseInt(fontSizeEl.value, 10);
            fontSizeVal.textContent = customFontSize; redraw();
        });
        textEl.addEventListener('input', () => redraw());
        document.getElementById('speakBtn').addEventListener('click', speakNow);

        function renderChips() {
            const samples = SAMPLE_TEXTS[langEl.value] || [];
            samplesEl.innerHTML = ''; samples.forEach(txt => {
                const chip = document.createElement('div'); chip.className = 'chip'; chip.textContent = txt;
                chip.onclick = () => { textEl.value = txt; redraw(); if (langEl.value === 'en-US') fetchIPA(txt); };
                samplesEl.appendChild(chip);
            });
        }

        loadVoices(); renderChips(); resizeCanvas();
    </script>
</body>

</html>